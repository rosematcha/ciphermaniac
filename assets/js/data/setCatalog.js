export const SET_CATALOG = [
  { code: 'MEG', name: 'Mega Evolution' },
  { code: 'MEP', name: 'Mega Promos' },
  { code: 'BLK', name: 'Black Bolt' },
  { code: 'WHT', name: 'White Flare' },
  { code: 'DRI', name: 'Destined Rivals' },
  { code: 'JTG', name: 'Journey Together' },
  { code: 'PRE', name: 'Prismatic Evolutions' },
  { code: 'SSP', name: 'Surging Sparks' },
  { code: 'SCR', name: 'Stellar Crown' },
  { code: 'SFA', name: 'Shrouded Fable' },
  { code: 'TWM', name: 'Twilight Masquerade' },
  { code: 'TEF', name: 'Temporal Forces' },
  { code: 'PAF', name: 'Paldean Fates' },
  { code: 'PAR', name: 'Paradox Rift' },
  { code: 'MEW', name: 'Pokémon 151' },
  { code: 'OBF', name: 'Obsidian Flames' },
  { code: 'PAL', name: 'Paldea Evolved' },
  { code: 'SVI', name: 'Scarlet & Violet' },
  { code: 'SVE', name: 'Scarlet & Violet Energy' },
  { code: 'SVP', name: 'Scarlet & Violet Promos' },
  { code: 'CRZ', name: 'Crown Zenith' },
  { code: 'SIT', name: 'Silver Tempest' },
  { code: 'LOR', name: 'Lost Origin' },
  { code: 'PGO', name: 'Pokémon GO' },
  { code: 'ASR', name: 'Astral Radiance' },
  { code: 'BRS', name: 'Brilliant Stars' },
  { code: 'FST', name: 'Fusion Strike' },
  { code: 'CEL', name: 'Celebrations' },
  { code: 'EVS', name: 'Evolving Skies' },
  { code: 'CRE', name: 'Chilling Reign' },
  { code: 'BST', name: 'Battle Styles' },
  { code: 'SHF', name: 'Shining Fates' },
  { code: 'VIV', name: 'Vivid Voltage' },
  { code: 'CPA', name: 'Champion\'s Path' },
  { code: 'DAA', name: 'Darkness Ablaze' },
  { code: 'RCL', name: 'Rebel Clash' },
  { code: 'SSH', name: 'Sword & Shield' },
  { code: 'SP', name: 'Sword & Shield Promos' },
  { code: 'CEC', name: 'Cosmic Eclipse' },
  { code: 'HIF', name: 'Hidden Fates' },
  { code: 'UNM', name: 'Unified Minds' },
  { code: 'UNB', name: 'Unbroken Bonds' },
  { code: 'DET', name: 'Detective Pikachu' },
  { code: 'TEU', name: 'Team Up' },
  { code: 'LOT', name: 'Lost Thunder' },
  { code: 'DRM', name: 'Dragon Majesty' },
  { code: 'CES', name: 'Celestial Storm' },
  { code: 'FLI', name: 'Forbidden Light' },
  { code: 'UPR', name: 'Ultra Prism' },
  { code: 'CIN', name: 'Crimson Invasion' },
  { code: 'SLG', name: 'Shining Legends' },
  { code: 'BUS', name: 'Burning Shadows' },
  { code: 'GRI', name: 'Guardians Rising' },
  { code: 'SUM', name: 'Sun & Moon' },
  { code: 'SMP', name: 'Sun & Moon Promos' },
  { code: 'EVO', name: 'Evolutions' },
  { code: 'STS', name: 'Steam Siege' },
  { code: 'FCO', name: 'Fates Collide' },
  { code: 'GEN', name: 'Generations' },
  { code: 'BKP', name: 'BREAKpoint' },
  { code: 'BKT', name: 'BREAKthrough' },
  { code: 'AOR', name: 'Ancient Origins' },
  { code: 'ROS', name: 'Roaring Skies' },
  { code: 'DCR', name: 'Double Crisis' },
  { code: 'PRC', name: 'Primal Clash' },
  { code: 'PHF', name: 'Phantom Forces' },
  { code: 'FFI', name: 'Furious Fists' },
  { code: 'FLF', name: 'Flashfire' },
  { code: 'XY', name: 'XY' },
  { code: 'KSS', name: 'Kalos Starter Set' },
  { code: 'XYP', name: 'XY Promos' },
  { code: 'LTR', name: 'Legendary Treasures' },
  { code: 'PLB', name: 'Plasma Blast' },
  { code: 'PLF', name: 'Plasma Freeze' },
  { code: 'PLS', name: 'Plasma Storm' },
  { code: 'BCR', name: 'Boundaries Crossed' },
  { code: 'DRV', name: 'Dragon Vault' },
  { code: 'DRX', name: 'Dragons Exalted' },
  { code: 'DEX', name: 'Dark Explorers' },
  { code: 'NXD', name: 'Next Destinies' },
  { code: 'NVI', name: 'Noble Victories' },
  { code: 'EPO', name: 'Emerging Powers' },
  { code: 'BLW', name: 'Black & White' },
  { code: 'BWP', name: 'Black & White Promos' },
  { code: 'CL', name: 'Call of Legends' },
  { code: 'TM', name: 'Triumphant' },
  { code: 'UD', name: 'Undaunted' },
  { code: 'UL', name: 'Unleashed' },
  { code: 'HS', name: 'HeartGold & SoulSilver' },
  { code: 'HSP', name: 'HeartGold & SoulSilver Promos' },
  { code: 'RM', name: 'Pokémon Rumble' },
  { code: 'AR', name: 'Arceus' },
  { code: 'SV', name: 'Supreme Victors' },
  { code: 'RR', name: 'Rising Rivals' },
  { code: 'P9', name: 'POP Series 9' },
  { code: 'PL', name: 'Platinum' },
  { code: 'SF', name: 'Stormfront' },
  { code: 'P8', name: 'POP Series 8' },
  { code: 'LA', name: 'Legends Awakened' },
  { code: 'MD', name: 'Majestic Dawn' },
  { code: 'P7', name: 'POP Series 7' },
  { code: 'GE', name: 'Great Encounters' },
  { code: 'SW', name: 'Secret Wonders' },
  { code: 'P6', name: 'POP Series 6' },
  { code: 'MT', name: 'Mysterious Treasures' },
  { code: 'DP', name: 'Diamond & Pearl' },
  { code: 'DPP', name: 'Diamond & Pearl Promos' },
  { code: 'P5', name: 'POP Series 5' },
  { code: 'PK', name: 'Power Keepers' },
  { code: 'DF', name: 'Dragon Frontiers' },
  { code: 'CG', name: 'Crystal Guardians' },
  { code: 'P4', name: 'POP Series 4' },
  { code: 'HP', name: 'Holon Phantoms' },
  { code: 'P3', name: 'POP Series 3' },
  { code: 'LM', name: 'Legend Maker' },
  { code: 'DS', name: 'Delta Species' },
  { code: 'UF', name: 'Unseen Forces' },
  { code: 'P2', name: 'POP Series 2' },
  { code: 'EM', name: 'Emerald' },
  { code: 'DX', name: 'Deoxys' },
  { code: 'TRR', name: 'Team Rocket Returns' },
  { code: 'P1', name: 'POP Series 1' },
  { code: 'RG', name: 'FireRed & LeafGreen' },
  { code: 'HL', name: 'Hidden Legends' },
  { code: 'MA', name: 'Team Magma vs Team Aqua' },
  { code: 'DR', name: 'Dragon' },
  { code: 'SS', name: 'Sandstorm' },
  { code: 'RS', name: 'Ruby & Sapphire' },
  { code: 'NP', name: 'Nintendo Promos' },
  { code: 'E3', name: 'Skyridge' },
  { code: 'E2', name: 'Aquapolis' },
  { code: 'BG', name: 'Best of Game' },
  { code: 'E1', name: 'Expedition' },
  { code: 'LC', name: 'Legendary Collection' },
  { code: 'N4', name: 'Neo Destiny' },
  { code: 'N3', name: 'Neo Revelation' },
  { code: 'SI', name: 'Southern Islands' },
  { code: 'N2', name: 'Neo Discovery' },
  { code: 'N1', name: 'Neo Genesis' },
  { code: 'G2', name: 'Gym Challenge' },
  { code: 'G1', name: 'Gym Heroes' },
  { code: 'TR', name: 'Team Rocket' },
  { code: 'BS2', name: 'Base Set 2' },
  { code: 'FO', name: 'Fossil' },
  { code: 'JU', name: 'Jungle' },
  { code: 'BS', name: 'Base Set' },
  { code: 'WP', name: 'WotC Promos' }
];

const SET_RELEASE_INDEX = new Map(SET_CATALOG.map((entry, index) => [entry.code, index]));
const SET_NAME_MAP = new Map(SET_CATALOG.map(entry => [entry.code, entry.name]));

export const ALL_SET_CODES = SET_CATALOG.map(entry => entry.code);

/**
 * Get the display name for a set code.
 * @param {string} code
 * @returns {string}
 */
export function getSetFullName(code) {
  if (!code) {return '';}
  const upper = code.toUpperCase();
  return SET_NAME_MAP.get(upper) || upper;
}

/**
 * Sort set codes by release order (newest first). Unknown codes are placed at the end alphabetically.
 * @param {Iterable<string>} codes
 * @returns {string[]}
 */
export function sortSetCodesByRelease(codes) {
  const unique = Array.from(new Set(Array.from(codes).map(code => code.toUpperCase()).filter(Boolean)));
  return unique.sort((left, right) => {
    const indexA = SET_RELEASE_INDEX.has(left) ? SET_RELEASE_INDEX.get(left) : Number.MAX_SAFE_INTEGER;
    const indexB = SET_RELEASE_INDEX.has(right) ? SET_RELEASE_INDEX.get(right) : Number.MAX_SAFE_INTEGER;
    if (indexA !== indexB) {
      return indexA - indexB;
    }
    return left.localeCompare(right);
  });
}

/**
 * Build structured label information for dropdowns (full name + acronym).
 * @param {string} code
 * @returns {{ label: string, fullName: string, code: string, codeLabel: string }}
 */
export function formatSetLabel(code) {
  const upper = code?.toUpperCase() || '';
  if (!upper) {return { label: '', fullName: '', code: '', codeLabel: '' };}
  const name = getSetFullName(upper);
  if (name === upper) {
    return {
      label: upper,
      fullName: upper,
      code: upper,
      codeLabel: ''
    };
  }
  return {
    label: `${name} (${upper})`,
    fullName: name,
    code: upper,
    codeLabel: upper
  };
}
