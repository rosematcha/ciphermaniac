# Cloudflare Pages configuration for Ciphermaniac
name = "ciphermaniac"
compatibility_date = "2023-10-30"
compatibility_flags = ["nodejs_compat"]

# Pages build output directory (required by Wrangler/Pages)
pages_build_output_dir = "public"

# KV namespace binding for price data storage
[[kv_namespaces]]
binding = "PRICE_DATA"
id = "c43f84feaa1049488390313c619610d8"

# R2 bucket binding for report storage
[[r2_buckets]]
bucket_name = "ciphermaniac-reports"
binding = "REPORTS"

# Production environment configuration
[env.production]

# KV namespace binding for production
[[env.production.kv_namespaces]]
binding = "PRICE_DATA"
id = "c43f84feaa1049488390313c619610d8"

# R2 bucket binding for production
[[env.production.r2_buckets]]
bucket_name = "ciphermaniac-reports"
binding = "REPORTS"

# Environment variables (set these in Cloudflare dashboard)
[env.production.vars]

# =============================================================================
# Preview Environment Configuration
# =============================================================================
# This environment mirrors production but uses separate resources for testing.
# Cloudflare Pages automatically uses this for non-production branch deployments.
#
# To deploy to preview:
#   npx wrangler pages deploy --env preview
#
# Required secrets (set via Cloudflare dashboard or wrangler secret):
#   - POKEMON_TCG_API_KEY: API key for Pokemon TCG data
#   - (Add other secrets your app requires)
#
# Before first deployment, create the preview KV namespace and R2 bucket:
#   npx wrangler kv:namespace create PRICE_DATA --env preview
#   npx wrangler r2 bucket create ciphermaniac-reports-preview
# =============================================================================

[env.preview]
name = "ciphermaniac-preview"

# KV namespace binding for preview
# Replace with actual ID after running: npx wrangler kv:namespace create PRICE_DATA --env preview
[[env.preview.kv_namespaces]]
binding = "PRICE_DATA"
id = "preview-price-data-kv-id"

# R2 bucket binding for preview
[[env.preview.r2_buckets]]
bucket_name = "ciphermaniac-reports-preview"
binding = "REPORTS"

# Preview environment variables
[env.preview.vars]
ENVIRONMENT = "preview"

