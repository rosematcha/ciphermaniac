<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ciphermaniac - Pok√©mon TCG Data</title>
    <!-- Preload critical font to reduce layout shift -->
    <link rel="preload" href="/assets/fonts/fraunces.woff2" as="font" type="font/woff2" crossorigin />
    <link rel="stylesheet" href="/assets/style.css" />
    <link rel="icon" type="image/svg+xml" href="/assets/images/logo.svg" />
  </head>
  <body class="no-header">
    <main id="main-content" class="home-page">
      <section class="hero">
        <div class="hero-content">
          <h1 class="hero-title">
            <img src="/assets/images/logo.svg" alt="Ciphermaniac Logo" class="hero-logo" width="110" height="110" />
            Ciphermaniac
          </h1>

          <div class="hero-search">
            <div class="search-wrap">
              <svg
                class="search-icon"
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                aria-hidden="true"
                focusable="false"
              >
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
              <input
                id="hero-search-input"
                type="search"
                placeholder="Search for a card..."
                aria-label="Search cards"
                autocomplete="off"
              />
              <datalist id="hero-card-names"></datalist>
              <div id="hero-card-suggestions" class="suggestions" role="listbox" aria-label="Card suggestions"></div>
            </div>
          </div>
        </div>
      </section>

      <section class="features-section" aria-label="Site features">
        <div class="features-grid">
          <a href="/cards" class="feature-card">
            <div class="feature-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="32"
                height="32"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                aria-hidden="true"
                focusable="false"
              >
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="3" y1="9" x2="21" y2="9"></line>
                <line x1="9" y1="21" x2="9" y2="9"></line>
              </svg>
            </div>
            <h3>Browse Cards</h3>
            <p>Explore usage statistics, prices, and deck inclusion rates for every card in the format.</p>
          </a>

          <a href="/archetypes" class="feature-card">
            <div class="feature-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="32"
                height="32"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                aria-hidden="true"
                focusable="false"
              >
                <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </div>
            <h3>Archetypes</h3>
            <p>Deep dive into the top performing decks. Analyze matchups, variants, and core lists.</p>
          </a>

          <a href="/trends" class="feature-card">
            <div class="feature-icon">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="32"
                height="32"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                aria-hidden="true"
                focusable="false"
              >
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
              </svg>
            </div>
            <h3>Meta Trends</h3>
            <p>Track the rise and fall of decks over time. See what's winning right now.</p>
          </a>
        </div>
      </section>
    </main>

    <script type="module">
      import { createFooter } from '/assets/js/components/footer.js';
      import { initCardSearch } from '/assets/js/components/cardSearch.js';

      // Insert footer
      const footer = createFooter();
      document.body.insertAdjacentElement('beforeend', footer);

      // Set random placeholder using the same cache as the search bar
      function setRandomPlaceholder() {
        const searchInput = document.getElementById('hero-search-input');
        if (!searchInput) return;

        try {
          // Use the same localStorage cache key as cardSearch.ts
          const cached = JSON.parse(localStorage.getItem('cardNamesUnionV5') || '{"names":[]}');
          let cardNames = [];

          if (Array.isArray(cached.names) && cached.names.length > 0) {
            // Use cached card names from search bar's data
            cardNames = cached.names;
          } else {
            // Fallback: Use same common cards as search bar when no cache exists
            cardNames = [
              "Boss's Orders",
              'Ultra Ball',
              "Professor's Research",
              'Iono',
              'Rare Candy',
              'Night Stretcher',
              'Nest Ball',
              'Counter Catcher'
            ];
          }

          if (cardNames.length > 0) {
            // Pick a random card
            const randomCard = cardNames[Math.floor(Math.random() * cardNames.length)];

            // Extract just the card name (remove set/number if present)
            const cardName = randomCard.split(' ').slice(0, -2).join(' ') || randomCard;

            searchInput.placeholder = `Search for a card (e.g. '${cardName}')...`;
          }
        } catch (error) {
          // Silently fail - keep default placeholder
          console.debug('Could not set random placeholder:', error);
        }
      }

      // Set placeholder immediately (synchronous, instant)
      setRandomPlaceholder();

      // Initialize search (this will populate the cache for next time)
      initCardSearch({
        searchInputId: 'hero-search-input',
        datalistId: 'hero-card-names',
        suggestionsId: 'hero-card-suggestions',
        onSubmit: value => {
          if (value) {
            window.location.href = `/cards?q=${encodeURIComponent(value)}`;
          }
        }
      });
    </script>
  </body>
</html>
